(()=>{var t={2601:(t,e,s)=>{t.exports=s(4444)},3565:(t,e,s)=>{"use strict";var r=s(1960);t.exports=r},2671:(t,e,s)=>{"use strict";s(2344),t.exports=s(5951)},4444:(t,e,s)=>{"use strict";t.exports=s(214)},214:(t,e,s)=>{"use strict";s(397);var r=s(3565);t.exports=r},2159:(t,e,s)=>{"use strict";var r=s(2250),i=s(4640),o=TypeError;t.exports=function(t){if(r(t))return t;throw new o(i(t)+" is not a function")}},6624:(t,e,s)=>{"use strict";var r=s(6285),i=String,o=TypeError;t.exports=function(t){if(r(t))return t;throw new o(i(t)+" is not an object")}},5807:(t,e,s)=>{"use strict";var r=s(1907),i=r({}.toString),o=r("".slice);t.exports=function(t){return o(i(t),8,-1)}},1626:(t,e,s)=>{"use strict";var r=s(9447),i=s(4284),o=s(5817);t.exports=r?function(t,e,s){return i.f(t,e,o(1,s))}:function(t,e,s){return t[e]=s,t}},5817:t=>{"use strict";t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},2532:(t,e,s)=>{"use strict";var r=s(5951),i=Object.defineProperty;t.exports=function(t,e){try{i(r,t,{value:e,configurable:!0,writable:!0})}catch(s){r[t]=e}return e}},9447:(t,e,s)=>{"use strict";var r=s(8828);t.exports=!r((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}))},9552:(t,e,s)=>{"use strict";var r=s(5951),i=s(6285),o=r.document,a=i(o)&&i(o.createElement);t.exports=function(t){return a?o.createElement(t):{}}},6794:(t,e,s)=>{"use strict";var r=s(5951).navigator,i=r&&r.userAgent;t.exports=i?String(i):""},798:(t,e,s)=>{"use strict";var r,i,o=s(5951),a=s(6794),n=o.process,h=o.Deno,u=n&&n.versions||h&&h.version,c=u&&u.v8;c&&(i=(r=c.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!i&&a&&(!(r=a.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=a.match(/Chrome\/(\d+)/))&&(i=+r[1]),t.exports=i},1091:(t,e,s)=>{"use strict";var r=s(5951),i=s(6024),o=s(2361),a=s(2250),n=s(3846).f,h=s(7463),u=s(2046),c=s(8311),l=s(1626),f=s(9724);s(6128);var d=function(t){var e=function(s,r,o){if(this instanceof e){switch(arguments.length){case 0:return new t;case 1:return new t(s);case 2:return new t(s,r)}return new t(s,r,o)}return i(t,this,arguments)};return e.prototype=t.prototype,e};t.exports=function(t,e){var s,i,p,b,_,g,m,S,A,E=t.target,T=t.global,y=t.stat,v=t.proto,w=T?r:y?r[E]:r[E]&&r[E].prototype,C=T?u:u[E]||l(u,E,{})[E],M=C.prototype;for(b in e)i=!(s=h(T?b:E+(y?".":"#")+b,t.forced))&&w&&f(w,b),g=C[b],i&&(m=t.dontCallGetSet?(A=n(w,b))&&A.value:w[b]),_=i&&m?m:e[b],(s||v||typeof g!=typeof _)&&(S=t.bind&&i?c(_,r):t.wrap&&i?d(_):v&&a(_)?o(_):_,(t.sham||_&&_.sham||g&&g.sham)&&l(S,"sham",!0),l(C,b,S),v&&(f(u,p=E+"Prototype")||l(u,p,{}),l(u[p],b,_),t.real&&M&&(s||!M[b])&&l(M,b,_)))}},8828:t=>{"use strict";t.exports=function(t){try{return!!t()}catch(t){return!0}}},6024:(t,e,s)=>{"use strict";var r=s(1505),i=Function.prototype,o=i.apply,a=i.call;t.exports="object"==typeof Reflect&&Reflect.apply||(r?a.bind(o):function(){return a.apply(o,arguments)})},8311:(t,e,s)=>{"use strict";var r=s(2361),i=s(2159),o=s(1505),a=r(r.bind);t.exports=function(t,e){return i(t),void 0===e?t:o?a(t,e):function(){return t.apply(e,arguments)}}},1505:(t,e,s)=>{"use strict";var r=s(8828);t.exports=!r((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}))},3930:(t,e,s)=>{"use strict";var r=s(1505),i=Function.prototype.call;t.exports=r?i.bind(i):function(){return i.apply(i,arguments)}},2361:(t,e,s)=>{"use strict";var r=s(5807),i=s(1907);t.exports=function(t){if("Function"===r(t))return i(t)}},1907:(t,e,s)=>{"use strict";var r=s(1505),i=Function.prototype,o=i.call,a=r&&i.bind.bind(o,o);t.exports=r?a:function(t){return function(){return o.apply(t,arguments)}}},5582:(t,e,s)=>{"use strict";var r=s(2046),i=s(5951),o=s(2250),a=function(t){return o(t)?t:void 0};t.exports=function(t,e){return arguments.length<2?a(r[t])||a(i[t]):r[t]&&r[t][e]||i[t]&&i[t][e]}},9367:(t,e,s)=>{"use strict";var r=s(2159),i=s(7136);t.exports=function(t,e){var s=t[e];return i(s)?void 0:r(s)}},5951:function(t,e,s){"use strict";var r=function(t){return t&&t.Math===Math&&t};t.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof s.g&&s.g)||r("object"==typeof this&&this)||function(){return this}()||Function("return this")()},9724:(t,e,s)=>{"use strict";var r=s(1907),i=s(9298),o=r({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return o(i(t),e)}},3648:(t,e,s)=>{"use strict";var r=s(9447),i=s(8828),o=s(9552);t.exports=!r&&!i((function(){return 7!==Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},6946:(t,e,s)=>{"use strict";var r=s(1907),i=s(8828),o=s(5807),a=Object,n=r("".split);t.exports=i((function(){return!a("z").propertyIsEnumerable(0)}))?function(t){return"String"===o(t)?n(t,""):a(t)}:a},2250:t=>{"use strict";var e="object"==typeof document&&document.all;t.exports=void 0===e&&void 0!==e?function(t){return"function"==typeof t||t===e}:function(t){return"function"==typeof t}},7463:(t,e,s)=>{"use strict";var r=s(8828),i=s(2250),o=/#|\.prototype\./,a=function(t,e){var s=h[n(t)];return s===c||s!==u&&(i(e)?r(e):!!e)},n=a.normalize=function(t){return String(t).replace(o,".").toLowerCase()},h=a.data={},u=a.NATIVE="N",c=a.POLYFILL="P";t.exports=a},7136:t=>{"use strict";t.exports=function(t){return null==t}},6285:(t,e,s)=>{"use strict";var r=s(2250);t.exports=function(t){return"object"==typeof t?null!==t:r(t)}},7376:t=>{"use strict";t.exports=!0},5594:(t,e,s)=>{"use strict";var r=s(5582),i=s(2250),o=s(8280),a=s(1175),n=Object;t.exports=a?function(t){return"symbol"==typeof t}:function(t){var e=r("Symbol");return i(e)&&o(e.prototype,n(t))}},4284:(t,e,s)=>{"use strict";var r=s(9447),i=s(3648),o=s(8661),a=s(6624),n=s(470),h=TypeError,u=Object.defineProperty,c=Object.getOwnPropertyDescriptor,l="enumerable",f="configurable",d="writable";e.f=r?o?function(t,e,s){if(a(t),e=n(e),a(s),"function"==typeof t&&"prototype"===e&&"value"in s&&d in s&&!s[d]){var r=c(t,e);r&&r[d]&&(t[e]=s.value,s={configurable:f in s?s[f]:r[f],enumerable:l in s?s[l]:r[l],writable:!1})}return u(t,e,s)}:u:function(t,e,s){if(a(t),e=n(e),a(s),i)try{return u(t,e,s)}catch(t){}if("get"in s||"set"in s)throw new h("Accessors not supported");return"value"in s&&(t[e]=s.value),t}},3846:(t,e,s)=>{"use strict";var r=s(9447),i=s(3930),o=s(2574),a=s(5817),n=s(7374),h=s(470),u=s(9724),c=s(3648),l=Object.getOwnPropertyDescriptor;e.f=r?l:function(t,e){if(t=n(t),e=h(e),c)try{return l(t,e)}catch(t){}if(u(t,e))return a(!i(o.f,t,e),t[e])}},8280:(t,e,s)=>{"use strict";var r=s(1907);t.exports=r({}.isPrototypeOf)},2574:(t,e)=>{"use strict";var s={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,i=r&&!s.call({1:2},1);e.f=i?function(t){var e=r(this,t);return!!e&&e.enumerable}:s},581:(t,e,s)=>{"use strict";var r=s(3930),i=s(2250),o=s(6285),a=TypeError;t.exports=function(t,e){var s,n;if("string"===e&&i(s=t.toString)&&!o(n=r(s,t)))return n;if(i(s=t.valueOf)&&!o(n=r(s,t)))return n;if("string"!==e&&i(s=t.toString)&&!o(n=r(s,t)))return n;throw new a("Can't convert object to primitive value")}},2046:t=>{"use strict";t.exports={}},4239:(t,e,s)=>{"use strict";var r=s(7136),i=TypeError;t.exports=function(t){if(r(t))throw new i("Can't call method on "+t);return t}},6128:(t,e,s)=>{"use strict";var r=s(7376),i=s(5951),o=s(2532),a="__core-js_shared__",n=t.exports=i[a]||o(a,{});(n.versions||(n.versions=[])).push({version:"3.39.0",mode:r?"pure":"global",copyright:"Â© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.39.0/LICENSE",source:"https://github.com/zloirock/core-js"})},5816:(t,e,s)=>{"use strict";var r=s(6128);t.exports=function(t,e){return r[t]||(r[t]=e||{})}},9846:(t,e,s)=>{"use strict";var r=s(798),i=s(8828),o=s(5951).String;t.exports=!!Object.getOwnPropertySymbols&&!i((function(){var t=Symbol("symbol detection");return!o(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},7374:(t,e,s)=>{"use strict";var r=s(6946),i=s(4239);t.exports=function(t){return r(i(t))}},9298:(t,e,s)=>{"use strict";var r=s(4239),i=Object;t.exports=function(t){return i(r(t))}},6028:(t,e,s)=>{"use strict";var r=s(3930),i=s(6285),o=s(5594),a=s(9367),n=s(581),h=s(6264),u=TypeError,c=h("toPrimitive");t.exports=function(t,e){if(!i(t)||o(t))return t;var s,h=a(t,c);if(h){if(void 0===e&&(e="default"),s=r(h,t,e),!i(s)||o(s))return s;throw new u("Can't convert object to primitive value")}return void 0===e&&(e="number"),n(t,e)}},470:(t,e,s)=>{"use strict";var r=s(6028),i=s(5594);t.exports=function(t){var e=r(t,"string");return i(e)?e:e+""}},4640:t=>{"use strict";var e=String;t.exports=function(t){try{return e(t)}catch(t){return"Object"}}},6499:(t,e,s)=>{"use strict";var r=s(1907),i=0,o=Math.random(),a=r(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+a(++i+o,36)}},1175:(t,e,s)=>{"use strict";var r=s(9846);t.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},8661:(t,e,s)=>{"use strict";var r=s(9447),i=s(8828);t.exports=r&&i((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},6264:(t,e,s)=>{"use strict";var r=s(5951),i=s(5816),o=s(9724),a=s(6499),n=s(9846),h=s(1175),u=r.Symbol,c=i("wks"),l=h?u.for||u:u&&u.withoutSetter||a;t.exports=function(t){return o(c,t)||(c[t]=n&&o(u,t)?u[t]:l("Symbol."+t)),c[t]}},2344:(t,e,s)=>{"use strict";var r=s(1091),i=s(5951);r({global:!0,forced:i.globalThis!==i},{globalThis:i})},397:(t,e,s)=>{"use strict";s(2344)},1960:(t,e,s)=>{"use strict";var r=s(2671);t.exports=r}},e={};function s(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={exports:{}};return t[r].call(o.exports,o,o.exports,s),o.exports}s.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return s.d(e,{a:e}),e},s.d=(t,e)=>{for(var r in e)s.o(e,r)&&!s.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";var t=s(2601),e=s.n(t),r=function(t,e){this._BYTES_PER_ELEMENT=e,this.capacity=(t.byteLength-8)/e,this.usableCapacity=this.capacity-1,this.buf=t,this.write_ptr=new Uint32Array(this.buf,0,1),this.read_ptr=new Uint32Array(this.buf,4,1),this.storageUint8s=new Uint8Array(this.buf,8,t.byteLength-8)};r.prototype.available_read=function(){var t=Atomics.load(this.read_ptr,0),e=Atomics.load(this.write_ptr,0);return this._available_read(t,e)},r.prototype._available_read=function(t,e){return(e+this.capacity-t)%this.capacity},r.prototype.dequeue=function(){var t=Atomics.load(this.read_ptr,0);let e=new Uint32Array(this.buf,t*this._BYTES_PER_ELEMENT+8,1);return this.storageUint8s.subarray(t*this._BYTES_PER_ELEMENT+4,t*this._BYTES_PER_ELEMENT+4+e[0])},r.prototype.addReadPtr=function(){var t=Atomics.load(this.read_ptr,0);Atomics.store(this.read_ptr,0,(t+1)%this.capacity)},r.prototype.getReaderPtr=function(){return this.read_ptr[0]},r.prototype.setReaderPtr=function(t){Atomics.store(this.read_ptr,0,t%this.capacity)},r.prototype.get=function(t){let e=t%this.capacity,s=new Uint32Array(this.buf,e*this._BYTES_PER_ELEMENT+8,1);return this.storageUint8s.subarray(e*this._BYTES_PER_ELEMENT+4,e*this._BYTES_PER_ELEMENT+4+s[0])};const i=r,o="MEDIASDK_CACHE_INFO";function a(t){postMessage({status:35,data:t})}function n(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e)return e.postMessage({status:48,data:t});postMessage({status:48,data:t})}new class{constructor(){this._highFrequencyLogs={},this.fixVersion="",this.cacheLogStack=[],this.isFlushing=!1}setInstance(t,e){this._instance=t,this.fixVersion=e}getMessageFromErrorOrEvent(t,e){let s=t;return e instanceof ErrorEvent?(e.filename&&(s+=` File: ${e.filename}`),(e.lineno||e.colno)&&(s+=` Line: ${e.lineno}:${e.colno}`),e.message&&(s+=` Message: ${e.message}`),e.error&&(s+=`\nStack: ${e.error.stack}`)):e instanceof Error?(e.message&&(s+=` Message: ${e.message}`),e.stack&&(s+=` Stack: ${e.stack}`),e.name&&(s+=` Name: ${e.name}`),e.constraint&&(s+=` Constraint: ${e.constraint}`)):e instanceof CloseEvent?(e.code&&(s+=` Code: ${e.code}`),e.reason&&(s+=` Reason: ${e.reason}`),s+=` wasClean: ${e.wasClean}`):e instanceof DOMException?(e.message&&(s+=` Message: ${e.message}`),e.name&&(s+=` Name: ${e.name}`)):s+=e?e.toString():"",s}_addCacheLog(t,e){this.cacheLogStack.length<100&&this.cacheLogStack.push({type:t,message:e})}flushCacheLog(){if(this._instance&&this.cacheLogStack.length>0&&!this.isFlushing){this.isFlushing=!0;let t="";this.cacheLogStack.forEach((e=>{let{type:s,message:{message:r="",tags:i=[]}}=e;const a=r?`${i.join("|")}:${r}|----|`:"";switch(s){case"log":this._log(r,[...i,o]);break;case"warn":case"error":case"severityerror":case"directReport":t+=a}})),t&&this._directReport(t,[o]),this.cacheLogStack=[],this.isFlushing=!1}}log(t,e=[]){this._instance?(this.flushCacheLog(),this._log(t,e)):this._addCacheLog("log",{message:t,tags:e})}warn(t,e=null,s=[]){t=this.getMessageFromErrorOrEvent(t,e),this._instance?(this.flushCacheLog(),this._warn(t,s)):this._addCacheLog("warn",{message:t,tags:s})}error(t,e=null,s=[]){var r;t=this.getMessageFromErrorOrEvent(t,e),this._highFrequencyLogs[t]?this._highFrequencyLogs[t]+=1:this._highFrequencyLogs[t]=1,!((r=this._highFrequencyLogs[t])&r-1)&&(this._instance?(this.flushCacheLog(),this._error(t,s)):this._addCacheLog("error",{message:t,tags:s}))}severityerror(t,e=[]){this._instance?(this.flushCacheLog(),this._severityerror(JSON.stringify(t),e)):this._addCacheLog("severityerror",{message:JSON.stringify(t),tags:e})}directReport(t,e=["MEDIASDK_INFO"]){var s;this._instance?(this.flushCacheLog(),null===(s=this._directReport)||void 0===s||s.call(this,t,e)):this._addCacheLog("directReport",{message:t,tags:e})}_log(t,e=[]){this._instance&&this._instance.log(t,e)}_warn(t,e=[]){this._instance&&this._instance.warn(t,e)}_error(t,e=[]){this._instance&&this._instance.error(t,[this.fixVersion,...e])}_severityerror(t,e=[]){this._instance&&this._instance.error(t,e)}_directReport(t,e=[]){var s,r;this._instance&&(null===(r=(s=this._instance).directReport)||void 0===r||r.call(s,{msg:t},e))}clearHighFrequencyLogs(){this._highFrequencyLogs={}}},new Error,new Map,new Map,new class{constructor(){this.ssrcInfoMap=new Map,this.timer=null}updateSSRCInfo(t,e){this.ssrcInfoMap.has(t)||this.ssrcInfoMap.set(t,{firstTime:0,lastTime:0,frames:0,fps:0}),this._calculateFPS(t,e),this._removeZeroFPS()}_calculateFPS(t,e){const s=this.ssrcInfoMap.get(t);if(0===s.frames?s.firstTime=e:s.lastTime=e,s.frames+=1,s.frames>2&&s.frames%5==0&&s.lastTime-s.firstTime>=1e3){const e=Math.floor(1e3/((s.lastTime-s.firstTime)/(s.frames-1)));s.fps!==e&&(this._notifyFPS(t,e),s.fps=e),s.firstTime=s.lastTime,s.frames=1}}_removeZeroFPS(){let t=Date.now();this.ssrcInfoMap.forEach(((e,s)=>{const r=this.ssrcInfoMap.get(s);r&&r.lastTime&&t-r.lastTime>2e3&&(this.ssrcInfoMap.delete(s),this._notifyFPS(s,0))}))}_notifyFPS(t,e){postMessage({status:66.6,data:{ssrc:t,fps:e}})}_checkIfNewFrameComing(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.timer=setTimeout((()=>{this._removeZeroFPS(),this.timer=null}),2500)}},new class{constructor(){this.ssrcInfoMap=new Map,this.timer=null}updateSSRCInfo(t,e){this.ssrcInfoMap.has(t)||this.ssrcInfoMap.set(t,{timeList:[],lastTime:0,fps:0}),this._calculateFPS(t,e),this._removeZeroFPS(),this._checkIfNewFrameComing()}_calculateFPS(t,e){const s=this.ssrcInfoMap.get(t);if(s.timeList.push(e),s.lastTime=e,s.timeList.length>2){const e=s.timeList[0],r=s.timeList[s.timeList.length-1];if(r-e>=1e3){const i=Math.floor(1e3/((r-e)/(s.timeList.length-1)));s.fps!==i&&(this._notifyFPS(t,i),s.fps=i),s.timeList=[]}}s.timeList.length>30&&(s.timeList=s.timeList.slice(s.timeList.length-30))}_removeZeroFPS(){this.ssrcInfoMap.forEach(((t,e)=>{const s=this.ssrcInfoMap.get(e);s&&Date.now()-s.lastTime>2e3&&(this.ssrcInfoMap.delete(e),this._notifyFPS(e,0))}))}_notifyFPS(t,e){postMessage({status:66.6,data:{ssrc:t,fps:e}})}_checkIfNewFrameComing(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.timer=setTimeout((()=>{this._removeZeroFPS(),this.timer=null}),2500)}};const h={ENCODE:1,DECODE:2,DECRPT:3,DECRPT_DECODE:4,WORKLET_APM_ONLY:5},u={MUTE:0,UNMUTE:1,LEAVED:2,MUTE_APM_ONLY:3,UNMUTE_APM_ONLY:4};let c,l,f=0;const d=new Map,p=[1,2,4,8,16,32,64,128,256];let b,_,g,m,S,A,E,T,y=!0;var v=0,w=!1,C=null,M=!1;const P={WASMTYPE:h,AUDIO_STATE:u,onWasmModuleReady:function(t){if(!t)return console.warn("[AudioWASMAdapter] Module undefined");b=t.cwrap("_Heartbeat","number",["number"]),_=t.cwrap("_MuteUnmuteState","number",["number","number"]),g=t.cwrap("_Switch_Original_Sound","number",["number","boolean","boolean","boolean","boolean"]),m=t.cwrap("_Deliver_Recorded_Data","number",["number","number","number","number","number","number"]),S=t.cwrap("_Switch_Denoise","number",["number","boolean","number","boolean"]),A=t.cwrap("_Audio_Init","number",["number","string","string","number","number","boolean","boolean","boolean","number","boolean"]),E=t.cwrap("_Switch_High_Bitrate","number",["number","number"]),T=t.cwrap("_Set_All_Speech_Volume_Level","number",["number"])},setAudioInstanceAndType:function(t,e,s){c=t,e&&(f=e),s&&(l=s)},muteUnmuteState:function(t){if(null!=Object.values(u).find((e=>e==t)))return c?void(f!=h.WORKLET_APM_ONLY&&(_(c,t),a("muteUnmuteState: "+t))):a("muteUnmuteState: -1")},switchOriginalSound:function(t,e,s,r){c&&g(c,t,e,s,r)},deliverRecordedData:function(t,e,s,r){c&&m(c,t,e,0,s,r)},switchDenoise:function(t,e,s=3){c&&(w=t,S(c,!!t,s,!!e))},audioInit:function(t,e,s,r,i,o,a,n,h,u){return A(t,e,s,r,i,o,a,n,h,u)},setDecoder:function(t){C=t},needCalculateDenoiseOutput:function(){M=!0},switchHighBitrate:function(t){c&&E(c,t)},disableJitterLog:function(){y=!1},setAllSpeechVolume:function(t){c&&T(c,t)},onMonitorLogWASM:function(t,e){if(e<=0)return;const s=Module.HEAPU8.subarray(t,t+e),r=String.fromCharCode.apply(null,s);r&&(!y&&r.includes("JITTER")||r.includes("WCL_MCM_AUDIO_RECEIVE")&&f!=h.DECRPT&&f!=h.DECRPT_DECODE||r.includes("WCL_MCM_AUDIO,")&&f==h.DECRPT||(f==h.ENCODE||f==h.DECRPT||f==h.DECRPT_DECODE?n(r):f==h.DECODE?l&&l.port&&n(r,l.port):f==h.WORKLET_APM_ONLY&&l.port&&l.port.postMessage({status:"SPEECH_LOG",data:{log:r}})))},onGlobalTracingLogWASM:function(t,e,s,r){if(e<=0)return;const i=Module.HEAPU8.subarray(t,t+e);let o=String.fromCharCode.apply(null,i);if(o){if(1==r){const t=`${r}_${s}_${o.substring(0,100)}`,e=(d.get(t)||0)+1;if(d.set(t,e),!p.includes(e)&&(e<256||e%256!=0))return;o=`${o} [Count: ${e}] `}switch(s){case 0:case 2:break;case 1:postMessage({status:61,errorMessage:"[WASM audio] "+o,level:"low"});break;case 3:!function(t,e=null){var s,r;if(e instanceof Error||e instanceof ErrorEvent){const i=e;t+=" Code: "+(null==i?void 0:i.code)+" Message: "+(null==e?void 0:e.message)+" Stack: "+(null!==(r=null===(s=null==i?void 0:i.error)||void 0===s?void 0:s.stack)&&void 0!==r?r:null==i?void 0:i.stack),e=null}postMessage({status:61,errorMessage:t,errorEvent:e})}("[WASM audio] "+o)}}},onMuteSpeechWarningWASM:function(){postMessage({status:121})},onAudioLevelWASM:function(t,e,s){f!=h.ENCODE&&f!=h.WORKLET_APM_ONLY||1==t&&(0===e&&0===v||(v=e,f===h.ENCODE?postMessage({status:38,value:e}):(null==l?void 0:l.port)&&l.port.postMessage({status:38,data:e})))},onAPMProcessedPCMWASM:function(t,e,s,r){if(!w)return;let i=Module.HEAPF32.subarray(t/4,t/4+e);if(C){if(M){M=!1;let{sumRms:t}=function(t,e){let s=0,r=0;for(let i=0;i<t.length;i+=e){r+=t[i]*t[i];let e=Math.abs(t[i]);e>s&&(s=e)}return s=s>1?1:s,{sumRms:r/t.length/e,absMax:s}}(i,2),e=function(t){let e=0;return e=t>.1995?15:t>.0794?14:t>.0316?13:t>.0126?12:t>.005?11:t>.002?10:t>79433e-8?9:t>31623e-8?8:t>12589e-8?7:t>50119e-9?6:t>19953e-9?5:t>79433e-10?4:t>31623e-10?3:t>12589e-10?2:t>5.0119e-7?1:0,e}(t);l.port&&l.port.postMessage({status:"AUDIO_LEVEL_R16_DENOISE",level:e})}C.push([i])}},onSenderStatsLogWASM:function(t,e,s,r,i,o){e=Date.now(),f===h.ENCODE&&postMessage({status:206,data:{ssrc:t,timestamp:e,roundTripTime:s,jitter:r,packetsLost:i,packetsSent:o,kind:"audio"}})},onReceiverStatsLogWASM:function(t,e,s,r,i,o){}};class D{constructor(){this.cacheSize=0,this.sameCacheSizeCounter=0}shouldSendCacheSize(t){return t===this.cacheSize&&this.sameCacheSizeCounter++,(this.cacheSize!==t||200===this.sameCacheSizeCounter)&&(this.sameCacheSizeCounter=0,this.cacheSize=t,!0)}}class L{constructor(t,e,s){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(this.STATE_READ_READY=0,this.STATE_READ_INDEX=1,this.STATE_WRITE_READY=2,this.STATE_WRITE_INDEX=3,this.STATE_DATA_COUNT=4,this.STATE_CACHE_SIZE=5,this.STATY_READY_NO=0,this.STATY_READY_YES=1,this.sabState=new Uint32Array(t),this.sabBuffer=new Float32Array(e),this.perFrameLength=s,this.writeChannelNumb=r,this.bufferLen=this.sabBuffer.length,this.supportSpecialOptimization=this.bufferLen%s==0,this.bufferIndex=null,this.supportSpecialOptimization){let t=this.bufferLen/s;this.bufferIndex=[];for(let e=0;e<t;e++)this.bufferIndex.push(this.sabBuffer.subarray(e*s,e*s+s))}this.placeBuffer=new Float32Array(this.perFrameLength),this.QUANTUM_SIZE=128,this.CACHE_SIZE_MAX_VALUE=Math.floor(Math.floor(this.bufferLen/this.QUANTUM_SIZE)/2),this.CACHE_SIZE_MIN_VALUE=6,this.CACHE_SIZE_MAX_VALUE<this.CACHE_SIZE_MIN_VALUE&&(this.CACHE_SIZE_MAX_VALUE=this.CACHE_SIZE_MIN_VALUE),this.setCacheSize(this.CACHE_SIZE_MIN_VALUE),this._counter=0,this.onCacheSizeChange=null,this.cacheSizeController=new D}getCacheSize(){return Atomics.load(this.sabState,this.STATE_CACHE_SIZE)}setCacheSize(t){t>this.CACHE_SIZE_MAX_VALUE&&(t=this.CACHE_SIZE_MAX_VALUE),t<this.CACHE_SIZE_MIN_VALUE&&(t=this.CACHE_SIZE_MIN_VALUE),this.onCacheSizeChange&&this.cacheSizeController.shouldSendCacheSize(t)&&this.onCacheSizeChange(t),Atomics.store(this.sabState,this.STATE_CACHE_SIZE,t)}setQuantumSize(t){this.QUANTUM_SIZE=t,this.CACHE_SIZE_MAX_VALUE=Math.floor(Math.floor(this.bufferLen/this.QUANTUM_SIZE)/2),this.CACHE_SIZE_MAX_VALUE<this.CACHE_SIZE_MIN_VALUE&&(this.CACHE_SIZE_MAX_VALUE=this.CACHE_SIZE_MIN_VALUE)}isNeedMoreData(){let t=Atomics.load(this.sabState,this.STATE_CACHE_SIZE);return Atomics.load(this.sabState,this.STATE_DATA_COUNT)<t*this.QUANTUM_SIZE}shouldAdjustCacheBuffer(){this._counter>0&&this.setCacheSize(this.getCacheSize()+1)}clear(){this.sabState&&(this.sabState[this.STATE_READ_READY]=0,this.sabState[this.STATE_READ_INDEX]=0,this.sabState[this.STATE_WRITE_READY]=0,this.sabState[this.STATE_WRITE_INDEX]=0,this.sabState[this.STATE_DATA_COUNT]=0),this._counter=0}setWriteReady(){this.sabState[this.STATE_WRITE_READY]=this.STATY_READY_YES}isReady(){return this.sabState[this.STATE_WRITE_READY]&&this.sabState[this.STATE_READ_READY]}getDataCount(){return Atomics.load(this.sabState,this.STATE_DATA_COUNT)}write(t){if(void 0===t[0]||t[0].length*this.writeChannelNumb!==this.perFrameLength)return;let e=this.sabState[this.STATE_READ_READY];return this.sabState[this.STATE_WRITE_READY]||(this.sabState[this.STATE_WRITE_READY]=this.STATY_READY_YES,this.sabState[this.STATE_WRITE_INDEX]=0),e?this.supportSpecialOptimization?this.writeSpecial(t):this.writeNormal(t):void 0}writeNormal(t){let e=this.sabState[this.STATE_WRITE_INDEX];for(let s=0;s<this.writeChannelNumb;s++)for(let r=0;t[s]&&r<t[s].length;r++)this.sabBuffer[(e+r*this.writeChannelNumb+s)%this.bufferLen]=t[s][r];e+=this.perFrameLength,e>=this.bufferLen&&(e-=this.bufferLen),this.sabState[this.STATE_WRITE_INDEX]=e,Atomics.add(this.sabState,this.STATE_DATA_COUNT,this.perFrameLength)}writeSpecial(t){let e=this.sabState[this.STATE_WRITE_INDEX];for(let s=0;s<this.writeChannelNumb;s++)for(let r=0;t[s]&&r<t[s].length;r++)this.bufferIndex[e][r*this.writeChannelNumb+s]=t[s][r];e=(e+1)%this.bufferIndex.length,this.sabState[this.STATE_WRITE_INDEX]=e,Atomics.add(this.sabState,this.STATE_DATA_COUNT,this.perFrameLength)}read(){let t=this.sabState[this.STATE_READ_READY],e=this.sabState[this.STATE_WRITE_READY];if(t||(this.sabState[this.STATE_READ_READY]=this.STATY_READY_YES,this.sabState[this.STATE_READ_INDEX]=0),!e)return null;let s=this.supportSpecialOptimization?this.readSpecial():this.readNormal();return null===s?this.shouldAdjustCacheBuffer():this._counter++,s}readNormal(){let t=this.sabState[this.STATE_READ_INDEX],e=Atomics.load(this.sabState,this.STATE_DATA_COUNT);if(e<this.perFrameLength)return null;if(e>this.bufferLen){let s=Math.ceil((e-this.bufferLen)/this.perFrameLength)+1;t=(s*this.perFrameLength+t)%this.bufferLen,Atomics.sub(this.sabState,this.STATE_DATA_COUNT,s*this.perFrameLength)}let s=null;if(this.bufferLen-t>=this.perFrameLength)s=this.sabBuffer.subarray(t,t+this.perFrameLength);else{let e=this.sabBuffer.subarray(t),r=this.sabBuffer.subarray(0,this.perFrameLength-e.length);s=this.placeBuffer,s.set(e),s.set(r,e.length)}return t+=this.perFrameLength,t>=this.bufferLen&&(t-=this.bufferLen),this.sabState[this.STATE_READ_INDEX]=t,Atomics.sub(this.sabState,this.STATE_DATA_COUNT,this.perFrameLength),s}readSpecial(){let t=this.sabState[this.STATE_READ_INDEX],e=Atomics.load(this.sabState,this.STATE_DATA_COUNT);if(e<this.perFrameLength)return null;if(e>this.bufferLen){let s=Math.ceil((e-this.bufferLen)/this.perFrameLength)+1;t=(s+t)%this.bufferIndex.length,Atomics.sub(this.sabState,this.STATE_DATA_COUNT,s*this.perFrameLength)}let s=this.bufferIndex[t];return t=(t+1)%this.bufferIndex.length,this.sabState[this.STATE_READ_INDEX]=t,Atomics.sub(this.sabState,this.STATE_DATA_COUNT,this.perFrameLength),s}}class R{constructor(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.rframes=t,this.wframes=e,this.writeChannelNumb=s,this.cap=this.lcm(t,e),this.buffer=new Float32Array(this.cap),this.remain=0,this.woffset=0,this.roffset=0}gcd(t,e){return 0===e?t:this.gcd(e,t%e)}lcm(t,e){return t/this.gcd(t,e)*e}push(t){if(null==t[0]||t[0].length*this.writeChannelNumb==this.wframes){for(let e=0;e<this.writeChannelNumb;e++)for(let s=0;s<t[0].length;s++)this.buffer[(this.woffset+s*this.writeChannelNumb+e)%this.cap]=t[e]?t[e][s]:t[0][s];this.woffset+=this.wframes,this.remain+=this.wframes,this.woffset>=this.cap&&(this.woffset=this.woffset%this.cap)}else{var e;console.error("[Audio] critical error in AudioWorklet: data.length:",t.length,"this.woffset:",this.woffset,"this.cap:",this.cap),_workletPrinter&&_workletPrinter.error("critical error in AudioWorklet: ".concat(null===(e=t[0])||void 0===e?void 0:e.length," ").concat(his.writeChannelNumb," ").concat(this.wframes))}}read(){if(!this.hasData())return null;let t=this.buffer.subarray(this.roffset,this.roffset+this.rframes);return this.remain-=this.rframes,this.roffset+=this.rframes,this.roffset>=this.cap&&(this.roffset=this.roffset%this.cap),t}hasData(){return this.remain>=this.rframes}clear(){this.buffer.fill(0),this.remain=0,this.woffset=0,this.roffset=0}}e().onWasmModuleReady=function(){P.onWasmModuleReady(Module),x=Module.cwrap("_Audio_Init","number",["number","string","string","number","number","boolean","boolean","boolean","number","boolean"]),(U=x(j,Y,H,0,0,!0,!1,!1,1))?P.setAudioInstanceAndType(U,P.WASMTYPE.DECODE,nt):_workletPrinter.error("audio_handle not exist"),F=Module.cwrap("_Audio_Try_Analysis","number",["number","number","number","number"]),W=Module.cwrap("_Get_Mixed_Audio","number",["number","number","number","number"]),z=Module.cwrap("_setMultiViewFlag","number",["number","boolean"]),q=Module.cwrap("_Interpretation_Configure","number",["number","number","number","number"]),K=Module.cwrap("_Set_Speech_Volume_Level","number",["number","number","number"]),Module.cwrap("_Get_Receiver_Monitor_Statistics","number",["number"]),st=Module.cwrap("_Set_Audio_Statistics_Flag","number",["number","boolean"]),Q=Module._malloc(4*tt),Module.HEAPU32.subarray(Q/4,Q/4+tt),z(U,Z),J=Module._malloc(et),Module.HEAP8.subarray(J,J+et),nt.port.postMessage({status:"WASM_INIT_SUCCESS",data:{audio_handle:0!==U}})},e().onAbort=function(t){_workletPrinter.error("WASM onAbort "+(t?t.message:""),t)},e().preInit=function(t){_workletPrinter.debug("WASM preInit"+(t?t.message:""),t)},e().preRun=function(t){_workletPrinter.debug("WASM preRun"+(t?t.message:""),t)},e()._workletPrinter=new class{constructor(t){this.messageQueue=[],this.auidoNodePort,this.userAgent="",this.isSafari=!1,this.debug=this.debug.bind(this),this.log=this.log.bind(this),this.warn=this.warn.bind(this),this.error=this.error.bind(this),this.print_=this.print_.bind(this),this.messageHeader=t}setUserAgent(t){this.userAgent=t,this.userAgent.match(/AppleWebKit\/(\d+)\./)&&(this.isSafari=!0)}setAuidoNodePort(t){this.auidoNodePort=t}debug(t){t=this.messageHeader+t;for(var e=arguments.length,s=new Array(e>1?e-1:0),r=1;r<e;r++)s[r-1]=arguments[r];this.print_({level:"debug",message:t,data:s})}log(t){t=this.messageHeader+t;for(var e=arguments.length,s=new Array(e>1?e-1:0),r=1;r<e;r++)s[r-1]=arguments[r];this.print_({level:"log",message:t,data:s})}warn(t){t=this.messageHeader+t;for(var e=arguments.length,s=new Array(e>1?e-1:0),r=1;r<e;r++)s[r-1]=arguments[r];this.print_({level:"warn",message:t,data:s})}error(t){t=this.messageHeader+t;for(var e=arguments.length,s=new Array(e>1?e-1:0),r=1;r<e;r++)s[r-1]=arguments[r];this.print_({level:"error",message:t,data:s})}print_(t){if(this.messageQueue.push(t),this.auidoNodePort)for(;this.messageQueue.length;){let t=this.messageQueue.shift();this._postToWorkerPrint(t)}}_postToWorkerPrint(t){this.auidoNodePort&&this.auidoNodePort.postMessage({status:"workletMessage",data:{level:t.level,message:t.message,data:t.data}})}}("[Audio][Worklet][WASM]"),e().AudioWasmAdapter=P;class I{constructor(){this.buffList=[],this.cacheMinSize=4,this.cacheMaxSize=16,this.cacheSize=this.cacheMinSize,this.onCacheSizeChange=null,this.onrollbackbuffer=null,this.onneedmoredata=null,this.isReady=!1,this.cacheSizeController=new D}push(t){this.isReady=!0,this.buffList.push({buff:t,offset:0})}copy(t,e,s,r){return t.length-e<=s.length-r?(0===e?s.set(t,r):s.set(t.subarray(e),r),t.length-e):(s.set(t.subarray(e,e+s.length-r),r),s.length-r)}increaseCacheSize(){this.isReady&&this.cacheSize++,this.cacheSize>this.cacheMaxSize&&(this.cacheSize=this.cacheMaxSize),this.onCacheSizeChange&&this.isReady&&this.cacheSizeController.shouldSendCacheSize(this.cacheSize)&&this.onCacheSizeChange(this.cacheSize)}copyTo(t){if(0===this.buffList.length)return t.fill(0),void this.increaseCacheSize();let e=this.buffList[0];if(e.buff.length-e.offset>=t.length)this.copy(e.buff,e.offset,t,0),e.offset+=t.length,e.offset===e.buff.length&&(this.buffList.shift(),this.onrollbackbuffer&&this.onrollbackbuffer(e.buff));else{if(this.buffList.length<2)return t.fill(0),void this.increaseCacheSize();let s=this.copy(e.buff,e.offset,t,0);this.buffList.shift(),this.onrollbackbuffer&&this.onrollbackbuffer(e.buff),e=this.buffList[0],s=this.copy(e.buff,e.offset,t,s),e.offset+=s}}requestMoreData(){this.buffList.length<this.cacheSize&&this.onneedmoredata&&this.onneedmoredata()}hasData(){return this.buffList.length>=2}}class N{constructor(t){this.buffList=[],this.frameLength=t,this.onframedata=null}copy(t,e,s,r){if(t[0].length*X<=s.length-r){for(let e=0;e<X;e++)for(let i=0;t[e]&&i<t[e].length;i++)s[r+i*X+e]=t[e][i];return(t[0].length-e)*X}for(let e=0;e<X;e++)for(let i=0;t[e]&&i<t[e].length&&r+i*X+e<s.length;i++)s[r+i*X+e]=t[e][i];return s.length-r}rollbackbuffer(t){this.buffList.push({buff:t,offset:0})}push(t){0===this.buffList.length&&this.buffList.push({buff:new Float32Array(this.frameLength),offset:0});let e=this.buffList[0];if(e.buff.length-e.offset>=t[0].length*X){let s=this.copy(t,0,e.buff,e.offset);e.offset+=s,e.buff.length===e.offset&&(this.buffList.shift(),this.onframedata&&this.onframedata(e.buff))}else{let s=this.copy(t,0,e.buff,e.offset);if(this.buffList.shift(),this.onframedata&&this.onframedata(e.buff),t[0].length*X>s){let e=[];for(let r=0;r<X;r++)e.push(t[r].subarray(Math.floor(s/X)+(s%X>r?1:0)));this.push(e)}}}}class O{constructor(t,e){this.context=e,this.decodePort=null,this.encodePort=null,this.captureSize=t/100*X,this.playBuffer=new I,this.playBuffer.onrollbackbuffer=t=>{this.decodePort},this.playBuffer.onneedmoredata=()=>{this.decodePort&&this.decodePort.postMessage({status:1})},this.playBuffer.onCacheSizeChange=t=>{this.decodePort&&this.decodePort.postMessage({status:3,cacheSize:t})},this.quantum=new Float32Array(128*G),this.captureBuffer=new N(this.captureSize),this.captureBuffer.onframedata=t=>{this.encodePort&&this.encodePort.postMessage({command:2,buffer:t},[t.buffer])}}setDecodePort(t){this.decodePort&&this.decodePort.close(),this.decodePort=t,this.decodePort.onmessage=this.handleDecodeData.bind(this)}setEncodePort(t){this.encodePort&&this.encodePort.close(),this.encodePort=t,this.encodePort.onmessage=this.handleEncodeData.bind(this)}handleDecodeData(t){this.context.isPlaying&&this.playBuffer.push(t.data.data)}handleEncodeData(t){0===t.data.event&&this.captureBuffer.rollbackbuffer(t.data.buffer)}requestMoreData(){this.playBuffer.requestMoreData()}close(){this.decodePort&&(this.decodePort=null,this.decodePort.close()),this.encodePort&&(this.encodePort=null,this.encodePort.close())}write(t){this.captureBuffer.push(t)}read(){return this.playBuffer.copyTo(this.quantum),this.requestMoreData(),this.quantum}}let k="undefined"!=typeof SharedArrayBuffer,B=!0;var x=null,F=null,U=null,W=null,z=null;let H=0,Y=0,j=0,V=0,Z=!1,X=1,G=1,$=null;var q,Q,K,J,tt=10;let et=1500;var st,rt={audioStatisticsFlag:!1};function it(t){let e=t[1];return 4294967296*t[2]+e}new Map,e().update_play_time=function(t,e){if(e){var s=new Uint8Array(e),r=Module.HEAP8.subarray(t+0,t+e);if(s.set(r),Z){var i;null===(i=nt.videoDecodePort)||void 0===i||i.postMessage({status:1,data:s},[s.buffer])}else{let t=new Uint32Array(s.buffer),e=null,r=null,i=0,o=0;for(let a=0;a<s.length/16;a++){let s=t[4*a];512&s?(e=t.subarray(4*a,4*a+4),o=it(e)):s>>10==V>>10&&(r=t.subarray(4*a,4*a+4),i=it(r))}if(!i&&!o)return;nt.port.postMessage({status:57,at:i,st:o})}}};let ot=null,at=null;e().frame_callback=function(t,e,s,r,i,o,a,n){ot===t&&at.length==e*a||(at=Module.HEAPF32.subarray(t/4,t/4+e*a),ot=t),$.push([at])};let nt=null;class ht extends AudioWorkletProcessor{static get parameterDescriptors(){return[{name:"pcm",defaultValue:1}]}constructor(t){var s,r;super(),nt=this,monitorLOG("WIB"),this.port.onmessage=this.handleMessage.bind(this),this.isPlaying=!1,this.isCapturing=!1,this.wasmModule=null==t||null===(s=t.processorOptions)||void 0===s?void 0:s.wasmModule,t&&t.processorOptions&&(t.processorOptions.audioEncodeChannelsNum&&(X=t.processorOptions.audioEncodeChannelsNum),t.processorOptions.audioDecodeChannelsNum&&(G=t.processorOptions.audioDecodeChannelsNum)),this.SABConstructor(t&&t.processorOptions?t.processorOptions.sharedBuffer:null),this.noSABConstructor(),e().fsHandler&&e().fsHandler.setPort(this.port),null!=t&&null!==(r=t.processorOptions)&&void 0!==r&&r.userAgent&&_workletPrinter.setUserAgent(t.processorOptions.userAgent),_workletPrinter.setAuidoNodePort(this.port),monitorLOG("WIE")}SABConstructor(t){this.sampleRate_=0,this.g_sharedbuffer=t||null,this.encodeSAB=null,this.decodeSAB=null,this.audioEncodePort=null,this.audioDecodePort=null,this.videoDecodePort=null,this.rtpSAB=null,this.stopPlayAudio=!1,$=new R(128*G,sampleRate/100*G)}noSABConstructor(){this.audioProcessBuffer=new O(sampleRate,this),this.isRunning=!0}handleMessage(t){const{status:e,data:s}=t.data;switch(e){case"diableSharedArrayBuffer":k=!1;break;case"disableDecoderinworklet":B=!1;break;case"data":console.info("Dropped audio data before initialized");break;case"stopPlayAudio":this.isPlaying=!1;break;case"stopWorklet":lt=!0;break;case"startPlayAudio":this.isPlaying=!0;break;case"StartCaptureAudio":this.isCapturing=!0;break;case"sampleRate":this.sampleRate_=s;break;case"audiowasm":try{initWasm(Module,this.wasmModule)}catch(t){nt.port.postMessage({status:"WASM_INIT_FAILED"}),_workletPrinter.error("init WASM failed, error message:"+t.message+t.stack)}break;case"initData":j=s.userid,H=s.meetingid,Y=s.meetingnum;break;case"currentSSRC":V=s;break;case"stop_audio_incoming":this.stopPlayAudio=s;break;case"codecDoAVSync":Z=!0,z&&U&&z(U,!0);break;case"checkProcess":{monitorLOG("PCC"+ft);let t=parseInt(1e3*dt/this.sampleRate_);monitorLOG("ADD:"+t),!ft!==pt&&(pt=!ft,nt.port.postMessage({status:"PROCESS_EXCEPTIONS",data:pt})),ft=0,dt=0;break}case"interpretation_set_lang":Module.HEAPU32.subarray(Q/4,Q/4+tt)[0]=s.lang,q(U,1,Q,1);break;case"interpretation_enable":Module.HEAPU32.subarray(Q/4,Q/4+tt)[0]=s.enable?1:0,q(U,0,Q,1);break;case"interpretation_mute_origin":Module.HEAPU32.subarray(Q/4,Q/4+tt)[0]=s.mute?1:0,q(U,2,Q,1);break;case"interpretation_set_interpreter":{let t=Module.HEAPU32.subarray(Q/4,Q/4+tt),e=Q;s.interpreterList.length>=tt&&(e=Module._malloc(4*s.interpreterList.length),t=Module.HEAPU32.subarray(e/4,e/4+s.interpreterList.length));for(let e=0;e<s.interpreterList.length;e++)t[e]=s.interpreterList[e];q(U,3,e,s.interpreterList.length),s.interpreterList.length>=tt&&Module._free(e);break}case"setSpeechVolumeLevel":if(!U)return;K(U,s.userid,s.volume);break;case 131:P.setAllSpeechVolume(s.volume);break;case 160:rt.audioStatisticsFlag=!!s.enable,r=rt.audioStatisticsFlag,U&&st(U,r);break;default:k?this.handleMessageForSAB(t):this.handleMessageForNoSAB(t)}var r}handleMessageForSAB(t){const{status:e,data:s}=t.data;switch(e){case"encodeAudioPort":this.audioEncodePort&&this.audioEncodePort.close(),this.audioEncodePort=t.ports[0];break;case"decodeAudioPort":this.audioDecodePort&&this.audioDecodePort.close(),this.audioDecodePort=t.ports[0],this.audioDecodePort.onmessage=function(t){};break;case"decodeVideoPort":this.videoDecodePort&&this.videoDecodePort.close(),this.videoDecodePort=t.ports[0];break;case"close":break;case"sharedBuffer":s&&(this.g_sharedbuffer=s),this.g_sharedbuffer&&(this.encodeSAB=new L(this.g_sharedbuffer.inputState,this.g_sharedbuffer.inputBuffer,128*X,X),this.decodeSAB=new L(this.g_sharedbuffer.outputState,this.g_sharedbuffer.outputBuffer,128*G),this.g_sharedbuffer.echoState&&this.g_sharedbuffer.echoBuffer&&(this.echoSAB=new L(this.g_sharedbuffer.echoState,this.g_sharedbuffer.echoBuffer,128*G,G)),this.rtpSAB=new i(this.g_sharedbuffer.rtpBuffer,1200),this.decodeSAB.onCacheSizeChange=t=>{this.audioDecodePort&&this.audioDecodePort.postMessage({status:3,cacheSize:t,isSAB:!0})});break;default:console.warn("unhanle commands in audioworklet",e)}}handleMessageForNoSAB(t){const{status:e}=t.data;switch(e){case"encodeAudioPort":this.audioProcessBuffer.setEncodePort(t.ports[0]);break;case"decodeAudioPort":this.audioProcessBuffer.setDecodePort(t.ports[0]);break;case"close":this.audioProcessBuffer.close(),this.isPlaying=!1,this.isRunning=!1;break;default:console.warn("unhanle commands in audioworklet",e)}}onReceivedRTP(){}process(t,e,s){if(ft++,lt)return!1;try{return k?B?this.SABDecodeProcess(t,e,s):this.SABProcess(t,e,s):this.NoSABprocess(t,e,s)}catch(t){return _workletPrinter.error("::process() exception: "+t.message+t.stack),!0}}NoSABprocess(t,e,s){return!(!this.isRunning||this.isPlaying&&(this.inputDataForNoSAB(t),this.outputDataForNoSAB(e),0))}inputDataForNoSAB(t){if(!t[0]||!t[0][0])return!0;let e=t[0];if(dt+=e[0].length,!ct&&t[0].length<X)try{for(let s=t[0].length;!ct&&s<X;s++)e.push(e[0])}catch(t){ct=!0,_workletPrinter.error("::inputDataForNoSAB() exception: "+t.message+t.stack)}this.audioProcessBuffer.write(e)}outputDataForNoSAB(t){let e=this.audioProcessBuffer.read();if(this.stopPlayAudio)return!0;let s=t[0];if(1===G)for(let t=0;t<s.length;t++)s[t].set(e);else for(let t=0;t<G;t++)for(let r=0;s[t]&&r<s[t].length;r++)s[t][r]=e[r*G+t]}inputData(t){if(!this.encodeSAB)return!0;dt+=t[0].length,this.encodeSAB.write(t),this.audioEncodePort.postMessage({command:2,buffer:!1})}outputDecodeData(t,s){try{$.hasData()||W&&(sampleRate!=ut&&(e().sampleRateLog(ut,sampleRate,"","",3),ut=sampleRate),W(U,sampleRate/100,0,sampleRate,G))}catch(t){_workletPrinter.error("::outputDecodeData() get_mixed_Audio exception: "+t.message+t.stack)}try{let e=$.read();if(!e)return;if(1===G)for(let s=0;s<t.length;s++)t[s].set(e);else for(let s=0;s<G;s++)for(let r=0;t[s]&&r<t[s].length;r++)t[s][r]=e[r*G+s];s&&this.echoSAB&&this.echoSAB.write(t)}catch(t){_workletPrinter.error("::outputDecodeData() set outputs exception: "+t.message+t.stack)}}outputData(t){if(!this.decodeSAB)return!0;let e=this.decodeSAB.read();if(null===e||this.stopPlayAudio)return!0;if(1===G)for(let s=0;s<t.length;s++)t[s].set(e);else for(let s=0;s<G;s++)for(let r=0;t[s]&&r<t[s].length;r++)t[s][r]=e[r*G+s]}SABDecodeProcess(t,s,r){try{if(!this.rtpSAB)return e().monitorLOG("SABN"),!0;{let t=this.rtpSAB.available_read();t>100&&(t=100);let e=this.rtpSAB.getReaderPtr(),s=0;for(;s<t;){s++;let t=this.rtpSAB.get(e);e++,U&&J&&(Module.HEAP8.subarray(J,J+et).set(t),F(U,0,J,t.length))}this.rtpSAB.setReaderPtr(e)}}catch(t){_workletPrinter.error("::SABDecodeProcess() audio_decode exception: "+t.message+t.stack)}try{let e=t[0],r=s[0];if(!this.g_sharedbuffer)return!0;if(!this.sampleRate_||!r[0])return!0;let i=e[0]&&this.isCapturing;if(i){if(e.length<X&&!ct)try{for(let t=e.length;!ct&&t<X;t++)e.push(e[0])}catch(t){ct=!0,_workletPrinter.error("::SABDecodeProcess() copy input data exception: "+t.message+t.stack)}this.inputData(e)}return this.outputDecodeData(r,i),!0}catch(t){_workletPrinter.error("::SABDecodeProcess() inputs or outputs exception: "+t.message+t.stack)}return!0}SABProcess(t,e,s){let r=t[0],i=e[0];if(!this.g_sharedbuffer)return!0;if(!this.sampleRate_||!i[0])return!0;if(r[0]&&this.isCapturing){if(!ct&&r.length<X)try{for(let t=r.length;!ct&&t<X;t++)r.push(r[0])}catch(t){ct=!0,_workletPrinter.error("::SABProcess() exception: "+t.message+t.stack)}this.inputData(r)}return this.outputData(i),!0}}var ut=0,ct=!1,lt=!1,ft=0,dt=0,pt=!1;e().LOG_OUT=function(){},e().fsHandler?(e().LOG_OUT_WEBRTC=e().fsHandler.handleFile,e().Get_ExternalRecord=e().fsHandler.handleViperPrint):(e().LOG_OUT_WEBRTC=function(){},e().Get_ExternalRecord=function(){}),e().send_data=function(){},e().monitorLOG=function(t){t&&nt.port.postMessage({status:"MONITOR_LOG",data:t})},e().sampleRateLog=function(t,s,r,i,o){if(!t&&!s)return;let a=null;switch(o){case 1:a="GGDS: ";break;case 2:a="SCAG: ";break;case 3:a="SCIW: "}let n=a+t+"|"+s+"|"+r+"|"+i;e().monitorLOG(n)},e().wcl_trace_log=function(t,s){e().fsHandler&&e().fsHandler.handleAudioSDKUtilPrint(t,s)},e().Viper_NetworkTrace=function(t,e){},registerProcessor("zoomAudioWorklet",ht)})()})();
//# sourceMappingURL=https://d1cdksi819e9z7.cloudfront.net/sourcemap/js_audio_worklet.min.js-6ef135f4bc6935cdfaa1.map